---
layout: post
title:  "Adsense responsivo e algumas notas"
description: "Ano novo, layout novo, e ads espalhados por ai. Duas breves explicações."
tags: 
- adsense 
- responsive
- SEO
image_thumb: "/media/adsense-responsivo-thumb.jpg"
image_highlight: "/media/adsense-responsivo.jpg"
comments: 
- author: Victor Naito
  date: 2014-12-24T22:30:04
  text: |
    <p>Foi utilizado algum framework para criação deste site?<br>Obrigado.</p>

- author: Leandro Oriente
  date: 2014-01-13T21:07:30
  text: |
    <p>Trabalhei melhor o schema. Não acredito que vá melhorar a nível de ranqueamento, mas ao menos pode melhorar a conversão.</p><p>Vou escrever outro artigo (polêmico) hoje pra ver se alavanco uns backlinks também =)</p>

- author: Leandro Oriente
  date: 2014-01-13T21:05:28
  text: |
    <p>Quanto a SERP, se estiver logado com conta google, deveria aparecer algo semelhante a isso:</p>

- author: Leandro Oriente
  date: 2014-01-13T20:52:28
  text: |
    <p>Cara, te contar que eles criaram sem minha autorização.</p><p>Puxaram os dados do Orkut na época e criaram a conta. Alguns amigos passaram por isso tb.<br>E pra excluir é um inferno rsrs.</p><p>Vou dar uma futicada aqui, mas vai ser complicado. Estava associada ao meu falecido hotmail =(</p>

- author: Matheus Kramer
  date: 2014-01-13T20:40:53
  text: |
    <p>Belo artigo, mas ao pesquisar "Leandro Oriente" eu só achei um perfil do Badoo hahahahhahauhdasiuhdiuashdiusad</p>

- author: Mario Ernesto
  date: 2014-01-13T20:21:09
  text: |
    <p>Show vou fazer uns testes nele. se chegar a algum resultado diferente publico por aqui.</p><p>quanto ao resultado testei em aba anônima e como tenho bloqueio no pc, o google não mapeia meus gostos pessoais. mas SEO é isso mesmo uma guerra diária pra manter-se no topo, ainda mais brigando com um gigante desses, mas só de você ser o segundo em uma busca tão genérica como essa, já é um resultado surpreendente.</p>

- author: Leandro Oriente
  date: 2014-01-13T14:44:19
  text: |
    <p>Putz, me passou de novo.</p><p>Maldito Jimmy Wales pedinte virtual husahsuahsa.<br>Vou fazer umas ligações e ver o que resolvo aqui.</p>

- author: Ricardo Arrigoni
  date: 2014-01-13T14:31:41
  text: |
    <p>Mesmo anônimo a Wikipédia está na frente ainda, mas mesmo assim é um resultado excelente!</p><p>BTW, ótimo artigo!</p>

- author: Leandro Oriente
  date: 2014-01-13T13:14:20
  text: |
    <p>Fica a vontade. Na vdd deixei ele bem mais enxuto para o Post. Faço algumas coisas a mais aqui no blog tb.</p><p>Quanto ao resultado, pode ser pq o google oferece resultados otimizados por usuário.<br>Tenta numa aba anônima, talvez eu esteja na frente.</p>

- author: Mario Ernesto
  date: 2014-01-13T12:38:17
  text: |
    <p>Eu também não resisti e escrevi "desenvolvedor front end" e alguma coisa milagrosa a Wikipedia fez que voltou ao topo. se me permitir posso usar, modificar e testar seu script?</p>

- author: Leandro Oriente
  date: 2014-01-13T12:07:18
  text: |
    <p>Se achar algo comento sim.<br>Já estava pensando em escrever um sobre SEO para pequenos Blogs onde citaria a integração com o G+.</p>

- author: Felipe Fialho
  date: 2014-01-13T11:48:51
  text: |
    <p>Quanto a isso do "mini profile", também consegui fazer, achei bem interessante.</p><p>Quando tiver uma resposta a essa questão de estar logado publicar pra gente ver \o</p>

- author: Leandro Oriente
  date: 2014-01-13T11:46:02
  text: |
    <p>Vlw <a data-dsq-mention="felipefialho:disqus" href="https://disqus.com/by/felipefialho/" rel="nofollow">Felipe Fialho</a>  =)</p><p>Outro ajuste que fiz relacionado a SERP foi relacionar melhor o meu perfil do Google Plus ao meu site.</p><p>Ao pesquisar por "Leandro Oriente" aparece um mini profile meu.<br>Só que ele só aparece se o usuário estiver logado na conta Google. Estou pesquisando ainda o porque, mas me parece alguma restrição do próprio Google.</p><p>Abs</p>

- author: Felipe Fialho
  date: 2014-01-13T11:37:29
  text: |
    <p>Leandro,</p><p>Obviamente não resisti e escrevi "desenvolvedor front end"... simplesmente assustador, haha. Incrível.</p><p>Gostei muito do novo visual, que seja um ótimo 2014 para todos \o</p>

- author: Mateus Avila Isidoro
  date: 2014-01-11T04:04:33
  text: |
    <p>Artigo realmente interessante. Parabéns. Muitos sites quebram no celular por não oferecer essa solução para seus clientes.</p>


---

Ano novo, layout novo, e ads espalhados por ai. Duas breves explicações.

*Obs: Vou me alongar em algumas explicações que fogem um pouco do foco do post. Se não estiver afim de ler, basta pular para a seção "Sem mais enrolações vamos ao Adsense responsivo".*

<!--more-->

## Novo layout

Mudei o layout para essa versão mais _clean_ porque foquei na melhor experiência de leitura possível para mim.

Tenho problemas de visão e uso uma extensão do Chrome chamada [Clearly](https://chrome.google.com/webstore/detail/clearly/iooicodkiihhpojmmeghjclgihfjdjhj?hl=en) desenvolvida pela galera do Evernote que tem uma formatação semelhante e usei o [Medium](https://medium.com) do Twitter como referência também.

Eu particularmente achei que ficou muito prático de ler. Espero que tenham gostado também.

Além disso adicionei os posts relacionados. Esse pequeno *improvement* gerou uma redução de 9% no bounce rate e 15% de aumento no número de páginas visitadas por usuário. Sou meio afixionado com testes e dados, gosto de mensurar tudo.

E já ia me esquecendo do scroll infinito de posts. Nada de paginação manual agora.

Voltando aos números, deu para manter o pagespeed da home em 93 e o ySlow em 90. Um dia chego à 100 e igualo o recorde do about:blank.

## Adsense no blog

Provavelmente você notou alguns Ads do google adsense espalhados pelo blog. Tenho meus motivos e o menor deles é ganhar dinheiro.

Sempre tive um foco muito grande em SEO. Trabalhei em um grande portal de conteúdo voltado para desenvolvedores como Analista por um tempo e fiz o curso da Agência Mestre (MestreSEO na época). Boa parte desse conhecimento é aplicado aqui no blog e pretendo dar meus pitacos sobre SEO em alguns posts.

<span class="not">Aliás gostaria de me parabenizar. Nos últimos dias ultrapassei o meu último rival pelo termo "desenvolvedor front end".</span> 

<span class="not">Um sitezinho com uns artigos sobre tudo que existe no mundo. Se não falha a memória se chama Wikipedia.</span>  

Maldito Jimmy Wales, mal posso ver seus movimentos. 

Voltando ao assunto. Tenho uma bagagem interessante de SEO, mas pouquíssima de Adwords e nunca tinha tocado em Adsense.

O blog agora com está 4k~5k de pageviews mensais e crescendo o que já serve de base para alguns testes de conversão e melhor entendimento da ferramenta. Não queria me arriscar com algum cliente sem ter um bom domínio antes.

"_Mas se o dinheiro não importa, o que você vai fazer com ele?_" <br /> 
O que qualquer pessoa sensata faria. Gastar em cerveja.

## Sem mais enrolações vamos ao Adsense responsivo

Vou separar a explicação em pequenos passos. É bem simples, mas procurei detalhar o máximo que eu pude. Se estiver muito explicadinho e cansativo, comente a respeito.

### Primeiro passo - Criar os anúncios no Adsense

Basta acessar o site do [Google Adsense](https://google.com/adsense), criar uma nova conta e criar um conjunto de anúncios. Chamarei os ads de anúncios no decorrer da explicação.

Os anúncios criados devem ser usados em um único ponto do site, ou seja, não use o mesmo anúncio várias vezes na mesma página. Eles tem um tamanho pré-definido ao serem criados. O google possui uma vasta [variedade de dimensões](https://support.google.com/adsense/answer/185665?utm_source=aso&utm_medium=link&utm_campaign=ww-ww-et-asfe_), inclusive uma que teoricamente é responsiva, mas está em *beta* e eu não levei muita fé no seu funcionamento.

No meu blog usei o seguinte conjunto de anúncios.

* Grupos com 970px x 90px para desktops.
* Grupos com 728px x 90px para tablets.
* Grupos com 320px x 50px para mobile

Criei dois de cada. Um para a lista de posts e um para os artigos. É importante que você crie anúncios diferentes para locais diferentes para facilitar na hora de mensurar os resultados.

Fiz alguns outros mais específicos, mas o importante para esse artigo são esses.

Ao criar um novo anúncio, o google fornece o código a seguir:

{% highlight html %}
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Header - banner -->
<ins class="adsbygoogle"
     style="display:inline-block;width:320px;height:50px"
     data-ad-client="ca-pub-999999999999"
     data-ad-slot="99999999"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
{% endhighlight %}

Ele deve ser inserido no local onde você deseja que o anúncio criado apareça. Porém não usaremos dessa forma.

Precisamos carregar anúncios diferentes no mesmo container (elemento) para cada resolução diferente. Usando o código gerado, você fica limitado a largura do anúncio.

### Segundo passo - Inserir o script do Adsense e containers dos anúncios

Notem que para cada anúncio gerado o google altera somente o estilo inline e os códigos passados no data do *ins*.

Peguei então o script 
{% highlight html %}
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
{% endhighlight %} 
Já que ele era chamado em todos os anúncios e isolei no footer, chamando uma única vez.

Depois foi necessário criar os containeirs dos anúncios, o local onde eu gostaria que eles fossem inseridos.

Nos locais desejados adicionei o seguinte elemento:

Para o final dos posts:
{% highlight html %}
<ins class="adsbygoogle" id="footer-post-ad"></ins>
{% endhighlight %}

Para a lista de posts:
{% highlight html %}
<ins class="adsbygoogle" id="home-list-ad"></ins>
{% endhighlight %}

É importante manter a classe *adsbygoogle* já que o google usa ela para verificar os anúncios da página.

Para cada *container* de anúncio, use um ID diferente. Ele vai ser usado para inserir os dados necessários no elemento.

### Terceiro passo - Script de renderização de anúncio e CSS

Vou colocar o script que desenvolvi usando Zepto (jQuery) como biblioteca e explico o funcionamento abaixo nos comentários.

{% highlight javascript %}
// Obviamente, espere o DOM estar devidamente no seu lugar antes de fazer qualquer coisa.
$(document).ready(function(){

  // Google Adsense registrando um array que ele observa para renderizar os anúncios
  adsbygoogle = window.adsbygoogle || [];

  // Alguns caches de seletores, já que vamos usar em diversos pontos
  // - Armazenando a largura do browser. Vamos usar para calcular qual
  // - formato ideal de anúncio a ser inserido
  var _browserSize = $(window).width(),
      ads = {},
      // Cache dos seletores com base no ID que usaram ao criar os containers
      $homeList = $('#home-list-ad'),
      $footerPost = $('#footer-post-ad');

  // Funções que distribuem os ads de acordo com a resolução do usuário
  // Criei 3 grupos, mas podem ser usados quantos quiserem, basta que
  // Tenham anúncios específicos para cada grupo
  ads.fillDesktopAds = function(){
    ads.renderElem('ca-pub-123123123', '123123123', $homeList, 'ad-970');
    ads.renderElem('ca-pub-234234234', '234234234', $footerPost, 'ad-970');
  };

  ads.fillTabletAds = function(){
    ads.renderElem('ca-pub-345345345', '345345345', $homeList, 'ad-728');
    ads.renderElem('ca-pub-456456456', '456456456', $footerPost, 'ad-728');
  };

  ads.fillMobileAds = function(){
    ads.renderElem('ca-pub-567567567', '567567567', $homeList, 'ad-320');
    ads.renderElem('ca-pub-678678678', '678678678', $footerPost, 'ad-320');
  };

  // Função usada para adicionar os dados do anúncio aos containers criados
  // Ela recebe os dois parâmetros do Google que ele informa ao criar um anúncio
  // O container (elemento) e a sua classe para customização do CSS
  ads.renderElem = function(adClient, adSlot, elem, elemClass) {
    // Verifica se o elemento existe de fato no DOM. O Google gera um erro caso
    // Você chame a rotina sem um novo elemento de anúncio na página
    if (elem.length) {
      // Usei o data separado por uma limitação da versão mais enxuta do Zepto
      // Podem usar o modo que recebe um objeto se estiverem usando jQuery
      elem.data('ad-client', adClient).data('ad-slot' , adSlot);
      // Classe usada para customização da largura e posicionamento do anúncio
      if (elemClass){
        elem.addClass(elemClass);
      }
      // Para cada anúncio criado é necessário  dar um push no array criado no início do post
      adsbygoogle.push({});
    }
  };

  // Verifica a largura do browser e chama a função correspondente.
  // Caso tenha muitos cenários, é melhor optar por um Switch
  if (_browserSize > 900) {
    ads.fillDesktopAds();
  } else if (_browserSize > 480) {
    ads.fillTabletAds();
  } else {
    ads.fillMobileAds();
  }
});
{% endhighlight %}

E agora o CSS. Basicamente ele vai definir a largura dos anúncios.

{% highlight css %}
.ad-970 {
  width: 970px;
  height: 90px;
  display: block;
}
.ad-728 {
  width: 728px;
  height: 90px;
  display: block;
}
.ad-320 {
  width: 320px;
  height: 50px;
  display: block;
}
{% endhighlight %}

### Concluindo

Basicamente é isso. Eu dei uma incrementada em algumas coisas para usar no meu blog, mas com esse código já é possível usar anúncios específicos para cada resolução que você deseje.

Você pode dar uma olhada no [código do blog](https://github.com/leandrooriente/leandrooriente) se quiser analisar o que eu fiz. Inclusive a função que mantém esse anúncio chato na lateral está no mesmo arquivo do [adsense.js](https://github.com/leandrooriente/leandrooriente/blob/master/src/static/scripts/adsense.js).

Espero que tenham aproveitado e qualquer dúvida é só comentar.
